# test_vulnerability_scanner.py

import pytest
from vulne_scanner import check_headers, port_scan, ssl_check, get_server_info, run_scan  # Import functions from your script

# Test function for check_headers
def test_check_headers():
    url = "https://facebook.com"
    headers = check_headers(url)
    assert headers["Strict-Transport-Security"] != "Missing"
    assert headers["Content-Security-Policy"] != "Missing"

# Test function for port_scan
def test_port_scan():
    domain = "facebook.com"
    open_ports = port_scan(domain)
    assert 443 in open_ports  # Facebook should have port 443 open for HTTPS

# Test function for ssl_check
def test_ssl_check():
    domain = "facebook.com"
    ssl_info = ssl_check(domain)
    assert isinstance(ssl_info, dict)  # It should return a dictionary with SSL certificate info

# Test function for get_server_info
def test_get_server_info():
    url = "https://facebook.com"
    server_info = get_server_info(url)
    assert "server" in server_info
    assert "title" in server_info
    assert server_info["title"] != "No Title"  # Facebook should have a title

# Test function for run_scan
def test_run_scan():
    url = "https://facebook.com"
    results = run_scan(url)
    assert "headers" in results
    assert "open_ports" in results
    assert "ssl_info" in results
    assert "server_info" in results
    assert isinstance(results["open_ports"], list)  # Should be a list of open ports
